<!DOCTYPE html>
<html>
  <head>
    <title>Fetch API</title>
    <meta charset="utf-8">
  </head>
  <body>
    <article>

    </article>
    <input type="button" value="fetch" onclick="

    /*fetch('html').then(function(response){
      response.text().then(function(text){
        alert(text);
        document.querySelector('article').innerHTML = text;
      })
    })
    */

    //Asynchronous(비동기)
    /*function callbackme(){
      console.log('response end');
    }
    */
    /*callbackme = function(){
      console.log('response end');
    }
    */

    fetch('html').then(function(response){
      console.log(response.status);
      if(response.status == '404'){
        alert('Not found');
      }
    });
    console.log('1');
    console.log('1');
    ">
    <h2>Fetch API</h2>

    <p>fetch()는 네트워크 요청을 쉽게 활용할 수 있게 만들어 준다. API를 가져올때 예전에는 XMLHttpRequest를 사용했으나,
      지금은 fetch를 통해 쉽게 가져올 수 있다.
      fetch()함수는 URL을 인자로 받고 응답을 처리하기 위한 promise를 반환한다.
      응답을 처리할 때 response 객체를 이용할 수 있다.</p>
    <p>fetch() use</p>
    <pre>
      fetch("/data.json").then(function(res) {
        // res instanceof Response == true.
        if (res.ok) {
          res.json().then(function(data) {
      console.log(data.entries);
    });
        } else {
          console.log("Looks like the response wasn't perfect, got status", res.status);
        }
      }, function(e) {
        console.log("Fetch failed!", e);
      });
    </pre>
    <pre>웹서버에는 'css'파일이 존재하고, 파일 안에 담긴 내용(text)가 호출. 모든 작업이 끝난 다음에는 alert(text)
    fetch('html').then(function(response){ // 1. 서버에게 웹서버에 있는 fetch 괄호안에 있는 파일을 요청하고, 응답이 끝나면
      response.text().then(function(text){ //2. /text라는 변수 안에 서버가 응답한 데이터가 들어가 있다
        alert(text); //3. 위의 작업이 끝나면 alert(text)의 text가 경고팝업 호출되도록 약속
      })
    })
  </pre>
  <pre>
    //Asynchronous(비동기)
    function callbackme(){
      console.log('response end');
    }

    callbackme = function(){ //위와 같음
      console.log('response end');
    }

    fetch('html').then(callbackme){ //callbackme에 행하는 내용을 callbackme에 넣고, 사용설명서와 같이 response 객체 입력값을 넣어준다.
      console.log(response.end);
    }

    fetch('html').then(function(response){ //response 객체의 status 속성을 가지고 404 에러 시 alert 호출할 수 있다.
      console.log(response.status);
      if(response.status == '404'){
        alert('Not found');
      }
    });
    </pre>
  </body>
</html>
